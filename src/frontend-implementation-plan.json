{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix Auto Planner “Save & Lock In” reliability and feedback",
  "requirements": [
    {
      "id": "REQ-2",
      "summary": "Make Auto Planner “Save & Lock In” run the full save sequence reliably with clear success/error feedback and proper loading/disable behavior.",
      "acceptanceCriteria": [
        "Clicking “Save & Lock In” in `frontend/src/components/AutoPlanner/AutoPlannerReview.tsx` performs the full save sequence without throwing a missing-method/actor error.",
        "When the save succeeds, a success toast is shown and `onSaveComplete()` is called, and the created goal appears in the goals list as locked in.",
        "When any step fails (create goal, add milestones/tasks, lock in), the UI shows an error toast with a readable message and the button returns to an enabled non-loading state (i.e., `isSaving` is reset).",
        "The button remains disabled while a save is in progress to prevent double-submission."
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/AutoPlanner/AutoPlannerReview.tsx",
          "operation": "modify",
          "description": "Refactor the “Save & Lock In” handler into an explicit, step-labeled async sequence using the existing actor connection. Add a runtime check that `createGoalWithCustomDuration` exists before calling it (otherwise show a readable error toast and abort) to avoid missing-method errors. Ensure per-step failure produces a clear error toast (including which step failed), and always reset `isSaving` in a `finally` block so the button re-enables. Keep the button disabled while saving to prevent double submission. After success, trigger React Query cache refresh (e.g., invalidate goals/goal queries) so the new locked-in goal appears reliably, then show a success toast and call `onSaveComplete()`. Verify the component's usage instructions before implementing."
        }
      ]
    }
  ]
}